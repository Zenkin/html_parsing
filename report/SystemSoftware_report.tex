\include{settings}

\begin{document}	% начало документа

% Титульная страница
\include{titlepage}

% Содержание
\include{ToC}


\section{Цель работы}
Написания программы для парсинга сайта с целью получения нужных данных, используюя Python. После загрузка полученной информации в Google Doc.

\section{Ход работы}

\subsection{Выбор среды программирования}
В качесте среды разработки был выбран PyCharm( рис. \ref{pic:pic_1}), разработанный копанией JetBrains на основе IntelliJ IDEA. Данная среда имеет множество достоинств, некоторые из их приведены ниже:

\begin{itemize}
	\item    Статический анализ кода, подсветка синтаксиса и ошибок.
	\item    Навигация по проекту и исходному коду: отображение файловой структуры проекта, быстрый переход между файлами, классами, методами и использованиями методов.
	\item    Рефакторинг: переименование, извлечение метода, введение переменной, введение константы, подъём и спуск метода и т. д.
	\item    Встроенный отладчик для Python
	\item    Поддержка систем контроля версий: общий пользовательский интерфейс для Mercurial, Git, Subversion, Perforce и CVS с поддержкой списков изменений и слияния
\end{itemize}
	
\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.25]{PyCharm_2}
		\caption{- интерфейс PyCharm} 
		\label{pic:pic_1} % название для ссылок внутри кода
	\end{center}
\end{figure}

\subsection{Разбитие проекта на модули}
В ходе выполнения проекта было принято решение разбить его на следующие пакеты:

\begin{itemize}

	\item main.py
	\item pars.py
	\item API.py
	\item GoogleDocAPI.py
	
\end{itemize}

В модуле main содержится основная программа, которая вызывает все функции из модулей.

Модуль pars содержит функции для парсинга сайта и получения информации с него.

Модуль API позволяет пользователю общаться с программой и выводить информацию в коммандную строку.

Модуль GoogleDocAPI осуществляет работу с Google Doc.

\subsection{Описание модуля pars}

\subsubsection{get\_top\_50}
Возвращает всю информацию о топ 50 кланах.
\lstinputlisting[
	label=code:plot,
	caption={get\_top\_50},
]{Get_top_50.py}
\parindent=1cm

\newpage

\subsubsection{get\_clans\_position,  get\_clans\_symbol\_of\_position,\\ get\_clans\_alliance,  get\_clans\_leader\_name,\\  get\_clans\_rating\_symbol}
Вспомогательные функции для get\_top\_50. Возвращают позицию клана, маркер позиции, альянс клана, имя лидера клана и маркер рейтинга клана
\lstinputlisting[
	label=code:plot,
	caption={group of functions for get\_top\_50},
]{top_50.py}
\parindent=1cm

\newpage

\subsubsection{get\_clan\_info}
Основная функция, которая возвращеат всю информацию о выбранном клане.
\lstinputlisting[
	label=code:plot,
	caption={get\_clan\_info},
]{get_clan_info.py}
\parindent=1cm

\subsubsection{get\_header\_info}
Вспомогательная функция для get\_clan\_info. Возвращает данные о ссылке, лидере, персонажах, профессий, текучке, альянсе, холле, замке, крепости, "О клане" выбранного клана.
\lstinputlisting[
	label=code:plot,
	caption={get\_header\_info},
]{GetHeaderInfo.py}
\parindent=1cm

\subsubsection{get\_member\_table}
Вспомогательная функция для get\_clan\_info. Возвращает всю информацию о членах выбранного клана.
\lstinputlisting[
	label=code:plot,
	caption={get\_member\_table},
]{GetMemberTable.py}
\parindent=1cm

\subsubsection{get\_clans\_statistic}
Возвращает статистику по клану.
\lstinputlisting[
	label=code:plot,
	caption={get\_clans\_statistic},
]{GetClanStats.py}
\parindent=1cm

\newpage

\subsubsection{get\_server\_stats}
Возвращает статистику по серверу.
\lstinputlisting[
	label=code:plot,
	caption={get\_server\_stats},
]{GetServerStats.py}
\parindent=1cm

\subsubsection{get\_clan\_stats}
Возвращает статистику по клану.
\lstinputlisting[
	label=code:plot,
	caption={get\_clan\_stats},
]{GetClanStats.py}
\parindent=1cm

\newpage

\subsubsection{get\_profession\_stats}
Возвращает статистику по профессиям сервера.
\lstinputlisting[
	label=code:plot,
	caption={get\_profession\_stats},
]{GetProfStats.py}
\parindent=1cm

\subsubsection{get\_second\_profession}
Вспомогательная функция для GetProfessionStats.
\lstinputlisting[
	label=code:plot,
	caption={get\_second\_profession},
]{GetSecondProfession.py}
\parindent=1cm

\newpage

\subsubsection{calc\_persentage}
Возвращает проценты по количеству профессий.
\lstinputlisting[
	label=code:plot,
	caption={calc\_persentage},
]{CalcPersentage.py}
\parindent=1cm

\subsubsection{get\_html\_code,\\ get\_url\_from\_str, get\_id, is\_in\_html\_code,\\ get\_name\_of\_th, get\_obj\_info}
Вспомогательные функции.
\lstinputlisting[
	label=code:plot,
	caption={get\_html\_code},
]{GetHtmlCode.py}
\parindent=1cm

\lstinputlisting[
	label=code:plot,
	caption={get\_url\_from\_str},
]{GetUrlFromStr.py}
\parindent=1cm

\lstinputlisting[
	label=code:plot,
	caption={get\_id},
]{GetId.py}
\parindent=1cm

\lstinputlisting[
	label=code:plot,
	caption={is\_in\_html\_code},
]{IsInHtmlCode.py}
\parindent=1cm

\newpage

\lstinputlisting[
	label=code:plot,
	caption={get\_name\_of\_th},
]{GetNameOfTh.py}
\parindent=1cm

\lstinputlisting[
	label=code:plot,
	caption={get\_obj\_info},
]{GetObfInfo.py}
\parindent=1cm

\lstinputlisting[
	label=code:plot,
	caption={is\_title},
]{is_title.py}
\parindent=1cm

\lstinputlisting[
	label=code:plot,
	caption={not\_in\_list},
]{not_in_list.py}
\parindent=1cm

\newpage

\subsection{Описание модуля API}

\subsubsection{clear\_screen}
Очищает экран командной строки.
\lstinputlisting[
	label=code:plot,
	caption={clear\_screen},
]{clear_screen.py}
\parindent=1cm

\subsubsection{get\_full\_url}
Возвращает полный путь к странице.
\lstinputlisting[
	label=code:plot,
	caption={get\_full\_url},
]{get_full_url.py}
\parindent=1cm

\subsubsection{get\_server\_number}
Позволяет пользователю выбрать желаемый сервер.
\lstinputlisting[
	label=code:plot,
	caption={get\_server\_number},
]{get_server_number.py}
\parindent=1cm

\subsubsection{choose\_clan}
Позволяет пользователю выбрать желаемый клан.
\lstinputlisting[
	label=code:plot,
	caption={choose\_clan},
]{choose_clan.py}
\parindent=1cm

\subsubsection{print\_top\_50}
Выводит в командную строку топ 50 кланов.
\lstinputlisting[
	label=code:plot,
	caption={print\_top\_50},
]{print_top_50.py}
\parindent=1cm

\subsubsection{print\_clan\_information}
Выводит в командную строку информацию о выбранном клане.
\lstinputlisting[
	label=code:plot,
	caption={print\_clan\_information},
]{print_clan_information.py}
\parindent=1cm

\newpage

\subsubsection{print\_clan\_stats}
Выводит в командную строку статистику клана.
\lstinputlisting[
	label=code:plot,
	caption={print\_clan\_stats},
]{print_clan_stats.py}
\parindent=1cm

\subsubsection{print\_server\_stats}
Выводит в командную строку статистику по серверу.
\lstinputlisting[
	label=code:plot,
	caption={print\_server\_stats},
]{print_server_stats.py}
\parindent=1cm

\newpage

\subsubsection{print\_server\_pofession\_stats}
Выводит в командную строку статистику по профессиям сервера.
\lstinputlisting[
	label=code:plot,
	caption={print\_server\_pofession\_stats},
]{print_server_pofession_stats.py}
\parindent=1cm

\newpage

\subsection{Описание модуля GoogleDocAPI}

\subsubsection{add\_to\_google\_sheet}
Добавляет данный в Google Doc.
\lstinputlisting[
	label=code:plot,
	caption={add\_to\_google\_sheet},
]{add_to_google_sheet.py}
\parindent=1cm

\subsubsection{add\_prof\_server\_stats}
Добавляет статистику по профессиям сервера в Google Doc.
\lstinputlisting[
	label=code:plot,
	caption={add\_prof\_server\_stats},
]{add_prof_server_stats.py}
\parindent=1cm

\subsubsection{load\_all\_data\_in\_google\_doc}
Загружает все в Google Doc.
\lstinputlisting[
	label=code:plot,
	caption={load\_all\_data\_in\_google\_doc},
]{load_all_data_in_google_doc.py}
\parindent=1cm

\newpage

\subsection{Описание main}

\lstinputlisting[
	label=code:plot,
	caption={main},
]{main.py}
\parindent=1cm

\newpage

\subsection{Примеры работы программы}

Примеры работы программы приведены на рисунках \ref{pic:pic_2} - \ref{pic:pic_11}.

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{1}
		\caption{- выбор сервера} 
		\label{pic:pic_2} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{2}
		\caption{- топ 50 кланов} 
		\label{pic:pic_3} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.4]{3}
		\caption{- информация о выбранном клане} 
		\label{pic:pic_4} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{4}
		\caption{- статистика по рассам} 
		\label{pic:pic_5} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{5}
		\caption{- статистика по классам} 
		\label{pic:pic_6} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{6}
		\caption{- статистика по лвлу} 
		\label{pic:pic_7} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{7}
		\caption{- статистика по 4 профессиям} 
		\label{pic:pic_8} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{8}
		\caption{- статистика по выбору профессий} 
		\label{pic:pic_9} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.5]{9}
		\caption{- пример вывода данных в Google Doc} 
		\label{pic:pic_10} % название для ссылок внутри кода
	\end{center}
\end{figure}

\begin{figure}[H]
	\begin{center}
		\includegraphics[scale=0.3]{10}
		\caption{- пример вывода данных в Google Doc} 
		\label{pic:pic_11} % название для ссылок внутри кода
	\end{center}
\end{figure}

\section{Вывод}
В данной лабораторной работе было получено большое количетво знаний в программировании на языке Python 3. Были освоены такие библиотеки, как BeautifulSoap4, urllib и gspread. Также все исхоные данные можно найти на репозитории:\\ https://github.com/Zenkin/l2onParsing.
\end{document}
